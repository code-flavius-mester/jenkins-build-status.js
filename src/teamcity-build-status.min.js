!function(t){t.fn.teamCityBuildStatus=function(t){return this.each(function(){new n(this,t)})};var n=function(n,i){function c(){s.getAll(function(t){t.forEach(r.create)})}var u=t("<div>").attr("id",i.projectId).addClass("project").appendTo(n),s=new e(i),r=new a(u,i);c()},e=function(n){var e="/guestAuth/app/rest/projects/id:";this.getAll=function(a){t.ajax({url:n.teamcityUrl+e+n.projectId,headers:{accept:"application/json"},success:function(t){a(t.buildTypes.buildType)}})}},a=function(t,n){this.create=function(e){return new i({projectElement:t,teamcityUrl:n.teamcityUrl,id:e.id,name:e.name})}},i=function(n){function e(){var e=t("<span>").addClass("name").text(n.name);c=t("<div>").attr("id",n.id).addClass(u).append(e).appendTo(n.projectElement)}function a(){t.ajax({url:s,headers:{accept:"application/json"},success:function(t){t.build.length>0&&i(t.build[0])}})}function i(t){c.prop("class",u).addClass(r[t.status]).toggleClass("running",!!t.running)}var c,u="build-stage",s=n.teamcityUrl+"/guestAuth/app/rest/builds?locator=buildType:(id:"+n.id+"),lookupLimit:10,running:any",r={FAILURE:"failed",SUCCESS:"success"};e(),a()}}(jQuery);