!function(t){t.fn.teamCityBuildStatus=function(t){return this.each(function(){new e(this,t)})};var e=function(e,i){function c(){u.getAll(function(t){t.forEach(r.create)})}var s=t("<div>").attr("id",i.projectId).addClass("project").appendTo(e),u=new a(i),r=new n(s,i);c()},a=function(e){var a="/guestAuth/app/rest/projects/id:";this.getAll=function(n){t.ajax({uri:e.teamcityUrl+a+e.projectId,headers:{accept:"application/json"},success:function(t){n(t.buildTypes)}})}},n=function(t,e){this.create=function(a){return new i({projectElement:t,teamcityUrl:e.teamcityUrl,id:a.id,name:a.name})}},i=function(e){function a(){var a=t("<span>").addClass("name").text(e.name);i=t("<div>").attr("id",e.id).addClass("build-stage").append(a).appendTo(e.projectElement)}function n(){t.ajax({uri:c,headers:{accept:"application/json"},success:function(t){if(t.build.length>0){var e=t.build[0].status;i.removeClass("success").removeClass("failed").addClass(s[e])}}})}var i,c=e.teamcityUrl+"/guestAuth/app/rest/builds?locator=buildType:(id:"+e.id+"),lookupLimit:2,running:any",s={FAILURE:"failed",SUCCESS:"success"};a(),n()}}(jQuery);